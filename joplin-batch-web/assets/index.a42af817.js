import{C as e,F as t,k as r,I as n,B as o,l as a}from"./vendor.bd0c5dc4.js";import{j as i}from"./joplinApiGenerator.a2502d33.js";import"./index.3b26dc49.js";var s=function(){},l="undefined"!=typeof window;export default()=>{var c;const[u]=t.useForm();const[p,m]=function(t,r,n){if(!l)return[r,s,s];if(!t)throw new Error("useLocalStorage key may not be falsy");var o=n?n.raw?function(e){return e}:n.deserializer:JSON.parse,a=e.exports.useRef((function(e){try{var t=n?n.raw?String:n.serializer:JSON.stringify,a=localStorage.getItem(e);return null!==a?o(a):(r&&localStorage.setItem(e,t(r)),r)}catch(i){return r}})),i=e.exports.useState((function(){return a.current(t)})),c=i[0],u=i[1];e.exports.useLayoutEffect((function(){return u(a.current(t))}),[t]);var p=e.exports.useCallback((function(e){try{var r="function"==typeof e?e(c):e;if(void 0===r)return;var a=void 0;a=n?n.raw?"string"==typeof r?r:JSON.stringify(r):n.serializer?n.serializer(r):JSON.stringify(r):JSON.stringify(r),localStorage.setItem(t,a),u(o(a))}catch(i){}}),[t,u]),m=e.exports.useCallback((function(){try{localStorage.removeItem(t),u(void 0)}catch(e){}}),[t,u]);return[c,p,m]}("settings");return e.exports.createElement(r,null,e.exports.createElement("h2",null,"安全设置"),e.exports.createElement(t,{form:u,onFinish:async function(){if(!(await u.validateFields()))return;const e=u.getFieldsValue();console.log("onFinish: ",e);try{await i.noteApi.list({limit:1}),m(e),a.success("设置成功")}catch(t){a.error("无法访问 joplin web clipper api")}},initialValues:{token:null==p?void 0:p.token,port:null!=(c=null==p?void 0:p.port)?c:41184}},e.exports.createElement(t.Item,{name:"token",label:"Token",rules:[{required:!0}]},e.exports.createElement(n,{type:"password"})),e.exports.createElement(t.Item,{name:"port",label:"Port",rules:[{required:!0}]},e.exports.createElement(n,{type:"number"})),e.exports.createElement(t.Item,null,e.exports.createElement(o,{type:"primary",htmlType:"submit"},"提交"))))};
