import{ac as e,p as t,ad as n,ae as r,C as o,ah as i,w as a,ak as s,I as c,s as l,Z as u,k as p,m as f,j as d,l as m,al as v,am as g,K as h,_ as x,n as w,y,an as C,A as b,G as E,ao as k,ap as N,z as P,aq as O,W as R,b as S,ab as M}from"./vendor.f9e4dcb2.js";import{n as T,j,B as z,e as L,f as I}from"./joplinApiGenerator.e693c4a0.js";import{C as A}from"./index.b1748e28.js";import{L as H}from"./index.edc0b3e1.js";import{E as U}from"./EyeOutlined.8fdc8957.js";import{S as D,p as W}from"./immer.esm.cc0cec8e.js";import{f as V,n as Y}from"./index.esm.84052b48.js";import{P as X}from"./PromiseUtil.6ae62114.js";import{i as B}from"./index.5ebcd3da.js";var G;function $(e){if("undefined"==typeof document)return 0;if(e||void 0===G){var t=document.createElement("div");t.style.width="100%",t.style.height="200px";var n=document.createElement("div"),r=n.style;r.position="absolute",r.top="0",r.left="0",r.pointerEvents="none",r.visibility="hidden",r.width="200px",r.height="150px",r.overflow="hidden",n.appendChild(t),document.body.appendChild(n);var o=t.offsetWidth;n.style.overflow="scroll";var i=t.offsetWidth;o===i&&(i=n.clientWidth),document.body.removeChild(n),G=o-i}return G}function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return{};var n=t.element,r=void 0===n?document.body:n,o={},i=Object.keys(e);return i.forEach((function(e){o[e]=r.style[e]})),i.forEach((function(t){r.style[t]=e[t]})),o}var K={},Z=function(e){if(document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth||e){var t="ant-scrolling-effect",n=new RegExp("".concat(t),"g"),r=document.body.className;if(e){if(!n.test(r))return;return q(K),K={},void(document.body.className=r.replace(n,"").trim())}var o=$();if(o&&(K=q({position:"relative",width:"calc(100% - ".concat(o,"px)")}),!n.test(r))){var i="".concat(r," ").concat(t);document.body.className=i.trim()}}},F=[],_=new RegExp("".concat("ant-scrolling-effect"),"g"),J=0,Q=new Map,ee=function n(r){var o=this;e(this,n),this.lockTarget=void 0,this.options=void 0,this.getContainer=function(){var e;return null===(e=o.options)||void 0===e?void 0:e.container},this.reLock=function(e){var t=F.find((function(e){return e.target===o.lockTarget}));t&&o.unLock(),o.options=e,t&&(t.options=e,o.lock())},this.lock=function(){var e;if(!F.some((function(e){return e.target===o.lockTarget})))if(F.some((function(e){var t,n=e.options;return(null==n?void 0:n.container)===(null===(t=o.options)||void 0===t?void 0:t.container)})))F=[].concat(t(F),[{target:o.lockTarget,options:o.options}]);else{var n=0,r=(null===(e=o.options)||void 0===e?void 0:e.container)||document.body;(r===document.body&&window.innerWidth-document.documentElement.clientWidth>0||r.scrollHeight>r.clientHeight)&&(n=$());var i=r.className;if(0===F.filter((function(e){var t,n=e.options;return(null==n?void 0:n.container)===(null===(t=o.options)||void 0===t?void 0:t.container)})).length&&Q.set(r,q({width:0!==n?"calc(100% - ".concat(n,"px)"):void 0,overflow:"hidden",overflowX:"hidden",overflowY:"hidden"},{element:r})),!_.test(i)){var a="".concat(i," ").concat("ant-scrolling-effect");r.className=a.trim()}F=[].concat(t(F),[{target:o.lockTarget,options:o.options}])}},this.unLock=function(){var e,t=F.find((function(e){return e.target===o.lockTarget}));if(F=F.filter((function(e){return e.target!==o.lockTarget})),t&&!F.some((function(e){var n,r=e.options;return(null==r?void 0:r.container)===(null===(n=t.options)||void 0===n?void 0:n.container)}))){var n=(null===(e=o.options)||void 0===e?void 0:e.container)||document.body,r=n.className;_.test(r)&&(q(Q.get(n),{element:n}),Q.delete(n),n.className=n.className.replace(_,"").trim())}},this.lockTarget=J++,this.options=r},te=0,ne=c(),re={},oe=function(e){if(!ne)return null;if(e){if("string"==typeof e)return document.querySelectorAll(e)[0];if("function"==typeof e)return e();if("object"===l(e)&&e instanceof window.HTMLElement)return e}return document.body},ie=function(t){n(l,t);var c=r(l);function l(t){var n;return e(this,l),(n=c.call(this,t)).container=void 0,n.componentRef=o.exports.createRef(),n.rafId=void 0,n.scrollLocker=void 0,n.renderComponent=void 0,n.updateScrollLocker=function(e){var t=(e||{}).visible,r=n.props,o=r.getContainer,i=r.visible;i&&i!==t&&ne&&oe(o)!==n.scrollLocker.getContainer()&&n.scrollLocker.reLock({container:oe(o)})},n.updateOpenCount=function(e){var t=e||{},r=t.visible,o=t.getContainer,i=n.props,a=i.visible,s=i.getContainer;a!==r&&ne&&oe(s)===document.body&&(a&&!r?te+=1:e&&(te-=1)),("function"==typeof s&&"function"==typeof o?s.toString()!==o.toString():s!==o)&&n.removeCurrentContainer()},n.attachToParent=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||n.container&&!n.container.parentNode){var t=oe(n.props.getContainer);return!!t&&(t.appendChild(n.container),!0)}return!0},n.getContainer=function(){return ne?(n.container||(n.container=document.createElement("div"),n.attachToParent(!0)),n.setWrapperClassName(),n.container):null},n.setWrapperClassName=function(){var e=n.props.wrapperClassName;n.container&&e&&e!==n.container.className&&(n.container.className=e)},n.removeCurrentContainer=function(){var e,t;null===(e=n.container)||void 0===e||null===(t=e.parentNode)||void 0===t||t.removeChild(n.container)},n.switchScrollingEffect=function(){1!==te||Object.keys(re).length?te||(q(re),re={},Z(!0)):(Z(),re=q({overflow:"hidden",overflowX:"hidden",overflowY:"hidden"}))},n.scrollLocker=new ee({container:oe(t.getContainer)}),n}return i(l,[{key:"componentDidMount",value:function(){var e=this;this.updateOpenCount(),this.attachToParent()||(this.rafId=a((function(){e.forceUpdate()})))}},{key:"componentDidUpdate",value:function(e){this.updateOpenCount(e),this.updateScrollLocker(e),this.setWrapperClassName(),this.attachToParent()}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.visible,n=e.getContainer;ne&&oe(n)===document.body&&(te=t&&te?te-1:te),this.removeCurrentContainer(),a.cancel(this.rafId)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.forceRender,r=e.visible,i=null,a={getOpenCount:function(){return te},getContainer:this.getContainer,switchScrollingEffect:this.switchScrollingEffect,scrollLocker:this.scrollLocker};return(n||r||this.componentRef.current)&&(i=o.exports.createElement(s,{getContainer:this.getContainer,ref:this.componentRef},t(a))),i}}]),l}(o.exports.Component);function ae(e){var t=e.prefixCls,n=e.style,r=e.visible,i=e.maskProps,a=e.motionName;return o.exports.createElement(u,{key:"mask",visible:r,motionName:a,leavedClassName:"".concat(t,"-mask-hidden")},(function(e){var r=e.className,a=e.style;return o.exports.createElement("div",p({style:f(f({},a),n),className:d("".concat(t,"-mask"),r)},i))}))}function se(e,t,n){var r=t;return!r&&n&&(r="".concat(e,"-").concat(n)),r}var ce=-1;function le(e,t){var n=e["page".concat(t?"Y":"X","Offset")],r="scroll".concat(t?"Top":"Left");if("number"!=typeof n){var o=e.document;"number"!=typeof(n=o.documentElement[r])&&(n=o.body[r])}return n}var ue=o.exports.memo((function(e){return e.children}),(function(e,t){return!t.shouldUpdate})),pe={width:0,height:0,overflow:"hidden",outline:"none"},fe=o.exports.forwardRef((function(e,t){var n=e.closable,r=e.prefixCls,i=e.width,a=e.height,s=e.footer,c=e.title,l=e.closeIcon,v=e.style,g=e.className,h=e.visible,x=e.forceRender,w=e.bodyStyle,y=e.bodyProps,C=e.children,b=e.destroyOnClose,E=e.modalRender,k=e.motionName,N=e.ariaId,P=e.onClose,O=e.onVisibleChanged,R=e.onMouseDown,S=e.onMouseUp,M=e.mousePosition,T=o.exports.useRef(),j=o.exports.useRef(),z=o.exports.useRef();o.exports.useImperativeHandle(t,(function(){return{focus:function(){var e;null===(e=T.current)||void 0===e||e.focus()},changeActive:function(e){var t=document.activeElement;e&&t===j.current?T.current.focus():e||t!==T.current||j.current.focus()}}}));var L,I,A,H=o.exports.useState(),U=m(H,2),D=U[0],W=U[1],V={};function Y(){var e,t,n,r,o,i=(e=z.current,t=e.getBoundingClientRect(),n={left:t.left,top:t.top},r=e.ownerDocument,o=r.defaultView||r.parentWindow,n.left+=le(o),n.top+=le(o,!0),n);W(M?"".concat(M.x-i.left,"px ").concat(M.y-i.top,"px"):"")}void 0!==i&&(V.width=i),void 0!==a&&(V.height=a),D&&(V.transformOrigin=D),s&&(L=o.exports.createElement("div",{className:"".concat(r,"-footer")},s)),c&&(I=o.exports.createElement("div",{className:"".concat(r,"-header")},o.exports.createElement("div",{className:"".concat(r,"-title"),id:N},c))),n&&(A=o.exports.createElement("button",{type:"button",onClick:P,"aria-label":"Close",className:"".concat(r,"-close")},l||o.exports.createElement("span",{className:"".concat(r,"-close-x")})));var X=o.exports.createElement("div",{className:"".concat(r,"-content")},A,I,o.exports.createElement("div",p({className:"".concat(r,"-body"),style:w},y),C),L);return o.exports.createElement(u,{visible:h,onVisibleChanged:O,onAppearPrepare:Y,onEnterPrepare:Y,forceRender:x,motionName:k,removeOnLeave:b,ref:z},(function(e,t){var n=e.className,i=e.style;return o.exports.createElement("div",{key:"dialog-element",role:"document",ref:t,style:f(f(f({},i),v),V),className:d(r,g,n),onMouseDown:R,onMouseUp:S},o.exports.createElement("div",{tabIndex:0,ref:T,style:pe,"aria-hidden":"true"}),o.exports.createElement(ue,{shouldUpdate:h||x},E?E(X):X),o.exports.createElement("div",{tabIndex:0,ref:j,style:pe,"aria-hidden":"true"}))}))}));function de(e){var t=e.prefixCls,n=void 0===t?"rc-dialog":t,r=e.zIndex,i=e.visible,a=void 0!==i&&i,s=e.keyboard,c=void 0===s||s,l=e.focusTriggerAfterClose,u=void 0===l||l,x=e.scrollLocker,w=e.title,y=e.wrapStyle,C=e.wrapClassName,b=e.wrapProps,E=e.onClose,k=e.afterClose,N=e.transitionName,P=e.animation,O=e.closable,R=void 0===O||O,S=e.mask,M=void 0===S||S,T=e.maskTransitionName,j=e.maskAnimation,z=e.maskClosable,L=void 0===z||z,I=e.maskStyle,A=e.maskProps,H=o.exports.useRef(),U=o.exports.useRef(),D=o.exports.useRef(),W=o.exports.useState(a),V=m(W,2),Y=V[0],X=V[1],B=o.exports.useRef();function G(e){null==E||E(e)}B.current||(B.current="rcDialogTitle".concat(ce+=1));var $=o.exports.useRef(!1),q=o.exports.useRef(),K=null;return L&&(K=function(e){$.current?$.current=!1:U.current===e.target&&G(e)}),o.exports.useEffect((function(){return a&&X(!0),function(){}}),[a]),o.exports.useEffect((function(){return function(){clearTimeout(q.current)}}),[]),o.exports.useEffect((function(){return Y?(null==x||x.lock(),null==x?void 0:x.unLock):function(){}}),[Y,x]),o.exports.createElement("div",p({className:"".concat(n,"-root")},v(e,{data:!0})),o.exports.createElement(ae,{prefixCls:n,visible:M&&a,motionName:se(n,T,j),style:f({zIndex:r},I),maskProps:A}),o.exports.createElement("div",p({tabIndex:-1,onKeyDown:function(e){if(c&&e.keyCode===h.ESC)return e.stopPropagation(),void G(e);a&&e.keyCode===h.TAB&&D.current.changeActive(!e.shiftKey)},className:d("".concat(n,"-wrap"),C),ref:U,onClick:K,role:"dialog","aria-labelledby":w?B.current:null,style:f(f({zIndex:r},y),{},{display:Y?null:"none"})},b),o.exports.createElement(fe,p({},e,{onMouseDown:function(){clearTimeout(q.current),$.current=!0},onMouseUp:function(){q.current=setTimeout((function(){$.current=!1}))},ref:D,closable:R,ariaId:B.current,prefixCls:n,visible:a,onClose:G,onVisibleChanged:function(e){if(e){var t;if(!g(U.current,document.activeElement))H.current=document.activeElement,null===(t=D.current)||void 0===t||t.focus()}else{if(X(!1),M&&H.current&&u){try{H.current.focus({preventScroll:!0})}catch(n){}H.current=null}Y&&(null==k||k())}},motionName:se(n,N,P)}))))}fe.displayName="Content";var me=function(e){var t=e.visible,n=e.getContainer,r=e.forceRender,i=e.destroyOnClose,a=void 0!==i&&i,s=e.afterClose,c=o.exports.useState(t),l=m(c,2),u=l[0],f=l[1];return o.exports.useEffect((function(){t&&f(!0)}),[t]),!1===n?o.exports.createElement(de,p({},e,{getOpenCount:function(){return 2}})):r||!a||u?o.exports.createElement(ie,{visible:t,forceRender:r,getContainer:n},(function(t){return o.exports.createElement(de,p({},e,{destroyOnClose:a,afterClose:function(){null==s||s(),f(!1)}},t))})):null};function ve(e,t,n,r){var o=t+n,i=(n-r)/2;if(n>r){if(t>0)return x({},e,i);if(t<0&&o<r)return x({},e,-i)}else if(t<0||o>r)return x({},e,t<0?i:-i);return{}}function ge(e,t,n,r){var o={width:document.documentElement.clientWidth,height:window.innerHeight||document.documentElement.clientHeight},i=o.width,a=o.height,s=null;return e<=i&&t<=a?s={x:0,y:0}:(e>i||t>a)&&(s=f(f({},ve("x",n,e,i)),ve("y",r,t,a))),s}me.displayName="Dialog";var he=["visible","onVisibleChange","getContainer","current"],xe=o.exports.createContext({previewUrls:new Map,setPreviewUrls:function(){return null},current:null,setCurrent:function(){return null},setShowPreview:function(){return null},setMousePosition:function(){return null},registerImage:function(){return function(){return null}}}),we=xe.Provider,ye=["prefixCls","src","alt","onClose","afterClose","visible","icons"],Ce=o.exports.useState,be=o.exports.useEffect,Ee={x:0,y:0},ke=function(e){var t=e.prefixCls,n=e.src,r=e.alt,i=e.onClose;e.afterClose;var s=e.visible,c=e.icons,l=void 0===c?{}:c,u=w(e,ye),v=l.rotateLeft,g=l.rotateRight,h=l.zoomIn,y=l.zoomOut,b=l.close,E=l.left,k=l.right,N=Ce(1),P=m(N,2),O=P[0],R=P[1],S=Ce(0),M=m(S,2),T=M[0],j=M[1],z=function(e){var t=o.exports.useRef(null),n=o.exports.useState(e),r=m(n,2),i=r[0],s=r[1],c=o.exports.useRef([]);return o.exports.useEffect((function(){return function(){return t.current&&a.cancel(t.current)}}),[]),[i,function(e){null===t.current&&(c.current=[],t.current=a((function(){s((function(e){var n=e;return c.current.forEach((function(e){n=f(f({},n),e)})),t.current=null,n}))}))),c.current.push(e)}]}(Ee),L=m(z,2),I=L[0],A=L[1],H=o.exports.useRef(),U=o.exports.useRef({originX:0,originY:0,deltaX:0,deltaY:0}),D=o.exports.useState(!1),W=m(D,2),V=W[0],Y=W[1],X=o.exports.useContext(xe),B=X.previewUrls,G=X.current,$=X.isPreviewGroup,q=X.setCurrent,K=B.size,Z=Array.from(B.keys()),F=Z.indexOf(G),_=$?B.get(G):n,J=$&&K>1,Q=o.exports.useState({wheelDirection:0}),ee=m(Q,2),te=ee[0],ne=ee[1],re=function(){R((function(e){return e+1})),A(Ee)},oe=function(){O>1&&R((function(e){return e-1})),A(Ee)},ie=d(x({},"".concat(t,"-moving"),V)),ae="".concat(t,"-operations-operation"),se="".concat(t,"-operations-icon"),ce=[{icon:b,onClick:i,type:"close"},{icon:h,onClick:re,type:"zoomIn"},{icon:y,onClick:oe,type:"zoomOut",disabled:1===O},{icon:g,onClick:function(){j((function(e){return e+90}))},type:"rotateRight"},{icon:v,onClick:function(){j((function(e){return e-90}))},type:"rotateLeft"}],le=function(){if(s&&V){var e=H.current.offsetWidth*O,t=H.current.offsetHeight*O,n=H.current.getBoundingClientRect(),r=n.left,o=n.top,i=T%180!=0;Y(!1);var a=ge(i?t:e,i?e:t,r,o);a&&A(f({},a))}},ue=function(e){s&&V&&A({x:e.pageX-U.current.deltaX,y:e.pageY-U.current.deltaY})},pe=function(e){if(s){e.preventDefault();var t=e.deltaY;ne({wheelDirection:t})}};return be((function(){var e=te.wheelDirection;e>0?oe():e<0&&re()}),[te]),be((function(){var e,t,n=C(window,"mouseup",le,!1),r=C(window,"mousemove",ue,!1),o=C(window,"wheel",pe,{passive:!1});try{window.top!==window.self&&(e=C(window.top,"mouseup",le,!1),t=C(window.top,"mousemove",ue,!1))}catch(i){}return function(){n.remove(),r.remove(),o.remove(),e&&e.remove(),t&&t.remove()}}),[s,V]),o.exports.createElement(me,p({transitionName:"zoom",maskTransitionName:"fade",closable:!1,keyboard:!0,prefixCls:t,onClose:i,afterClose:function(){R(1),j(0),A(Ee)},visible:s,wrapClassName:ie},u),o.exports.createElement("ul",{className:"".concat(t,"-operations")},ce.map((function(e){var n=e.icon,r=e.onClick,i=e.type,a=e.disabled;return o.exports.createElement("li",{className:d(ae,x({},"".concat(t,"-operations-operation-disabled"),!!a)),onClick:r,key:i},o.exports.isValidElement(n)?o.exports.cloneElement(n,{className:se}):n)}))),o.exports.createElement("div",{className:"".concat(t,"-img-wrapper"),style:{transform:"translate3d(".concat(I.x,"px, ").concat(I.y,"px, 0)")}},o.exports.createElement("img",{onMouseDown:function(e){0===e.button&&(e.preventDefault(),e.stopPropagation(),U.current.deltaX=e.pageX-I.x,U.current.deltaY=e.pageY-I.y,U.current.originX=I.x,U.current.originY=I.y,Y(!0))},ref:H,className:"".concat(t,"-img"),src:_,alt:r,style:{transform:"scale3d(".concat(O,", ").concat(O,", 1) rotate(").concat(T,"deg)")}})),J&&o.exports.createElement("div",{className:d("".concat(t,"-switch-left"),x({},"".concat(t,"-switch-left-disabled"),0===F)),onClick:function(e){e.preventDefault(),e.stopPropagation(),F>0&&q(Z[F-1])}},E),J&&o.exports.createElement("div",{className:d("".concat(t,"-switch-right"),x({},"".concat(t,"-switch-right-disabled"),F===K-1)),onClick:function(e){e.preventDefault(),e.stopPropagation(),F<K-1&&q(Z[F+1])}},k))},Ne=["src","alt","onPreviewClose","prefixCls","previewPrefixCls","placeholder","fallback","width","height","style","preview","className","onClick","onError","wrapperClassName","wrapperStyle","crossOrigin","decoding","loading","referrerPolicy","sizes","srcSet","useMap"],Pe=["src","visible","onVisibleChange","getContainer","mask","maskClassName","icons"],Oe=0,Re=function(e){var t=e.src,n=e.alt,r=e.onPreviewClose,i=e.prefixCls,a=void 0===i?"rc-image":i,s=e.previewPrefixCls,c=void 0===s?"".concat(a,"-preview"):s,u=e.placeholder,v=e.fallback,g=e.width,h=e.height,C=e.style,b=e.preview,E=void 0===b||b,k=e.className,N=e.onClick,P=e.onError,O=e.wrapperClassName,R=e.wrapperStyle,S=e.crossOrigin,M=e.decoding,T=e.loading,j=e.referrerPolicy,z=e.sizes,L=e.srcSet,I=e.useMap,A=w(e,Ne),H=u&&!0!==u,U="object"===l(E)?E:{},D=U.src,W=U.visible,V=void 0===W?void 0:W,Y=U.onVisibleChange,X=void 0===Y?r:Y,B=U.getContainer,G=void 0===B?void 0:B,$=U.mask,q=U.maskClassName,K=U.icons,Z=w(U,Pe),F=null!=D?D:t,_=void 0!==V,J=y(!!V,{value:V,onChange:X}),Q=m(J,2),ee=Q[0],te=Q[1],ne=o.exports.useState(H?"loading":"normal"),re=m(ne,2),oe=re[0],ie=re[1],ae=o.exports.useState(null),se=m(ae,2),ce=se[0],le=se[1],ue="error"===oe,pe=o.exports.useContext(xe),fe=pe.isPreviewGroup,de=pe.setCurrent,me=pe.setShowPreview,ve=pe.setMousePosition,ge=pe.registerImage,he=o.exports.useState((function(){return Oe+=1})),we=m(he,1)[0],ye=E&&!ue,Ce=o.exports.useRef(!1),be=function(){ie("normal")};o.exports.useEffect((function(){return ge(we,F)}),[]),o.exports.useEffect((function(){ge(we,F,ye)}),[F,ye]),o.exports.useEffect((function(){ue&&ie("normal"),H&&!Ce.current&&ie("loading")}),[t]);var Ee=d(a,O,x({},"".concat(a,"-error"),ue)),Re=ue&&v?v:F,Se={crossOrigin:S,decoding:M,loading:T,referrerPolicy:j,sizes:z,srcSet:L,useMap:I,alt:n,className:d("".concat(a,"-img"),x({},"".concat(a,"-img-placeholder"),!0===u),k),style:f({height:h},C)};return o.exports.createElement(o.exports.Fragment,null,o.exports.createElement("div",p({},A,{className:Ee,onClick:ye?function(e){if(!_){var t=(o=e.target,i=o.getBoundingClientRect(),a=document.documentElement,{left:i.left+(window.pageXOffset||a.scrollLeft)-(a.clientLeft||document.body.clientLeft||0),top:i.top+(window.pageYOffset||a.scrollTop)-(a.clientTop||document.body.clientTop||0)}),n=t.left,r=t.top;fe?(de(we),ve({x:n,y:r})):le({x:n,y:r})}var o,i,a;fe?me(!0):te(!0),N&&N(e)}:N,style:f({width:g,height:h},R)}),o.exports.createElement("img",p({},Se,{ref:function(e){Ce.current=!1,"loading"===oe&&(null==e?void 0:e.complete)&&(e.naturalWidth||e.naturalHeight)&&(Ce.current=!0,be())}},ue&&v?{src:v}:{onLoad:be,onError:function(e){P&&P(e),ie("error")},src:t})),"loading"===oe&&o.exports.createElement("div",{"aria-hidden":"true",className:"".concat(a,"-placeholder")},u),$&&ye&&o.exports.createElement("div",{className:d("".concat(a,"-mask"),q)},$)),!fe&&ye&&o.exports.createElement(ke,p({"aria-hidden":!ee,visible:ee,prefixCls:c,onClose:function(e){e.stopPropagation(),te(!1),_||le(null)},mousePosition:ce,src:Re,alt:n,getContainer:G,icons:K},Z)))};Re.PreviewGroup=function(e){var t=e.previewPrefixCls,n=void 0===t?"rc-image-preview":t,r=e.children,i=e.icons,a=void 0===i?{}:i,s=e.preview,c="object"===l(s)?s:{},u=c.visible,f=void 0===u?void 0:u,d=c.onVisibleChange,v=void 0===d?void 0:d,g=c.getContainer,h=void 0===g?void 0:g,x=c.current,C=void 0===x?0:x,b=w(c,he),E=o.exports.useState(new Map),k=m(E,2),N=k[0],P=k[1],O=o.exports.useState(),R=m(O,2),S=R[0],M=R[1],T=y(!!f,{value:f,onChange:v}),j=m(T,2),z=j[0],L=j[1],I=o.exports.useState(null),A=m(I,2),H=A[0],U=A[1],D=void 0!==f,W=Array.from(N.keys())[C],V=new Map(Array.from(N).filter((function(e){return!!m(e,2)[1].canPreview})).map((function(e){var t=m(e,2);return[t[0],t[1].url]})));return o.exports.useEffect((function(){M(W)}),[W]),o.exports.useEffect((function(){!z&&D&&M(W)}),[W,D,z]),o.exports.createElement(we,{value:{isPreviewGroup:!0,previewUrls:V,setPreviewUrls:P,current:S,setCurrent:M,setShowPreview:L,setMousePosition:U,registerImage:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=function(){P((function(t){var n=new Map(t);return n.delete(e)?n:t}))};return P((function(r){return new Map(r).set(e,{url:t,canPreview:n})})),r}}},r,o.exports.createElement(ke,p({"aria-hidden":!z,visible:z,prefixCls:n,onClose:function(e){e.stopPropagation(),L(!1),U(null)},mousePosition:H,src:V.get(S),icons:a,getContainer:h},b)))},Re.displayName="Image";var Se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M672 418H144c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H188V494h440v326z"}},{tag:"path",attrs:{d:"M819.3 328.5c-78.8-100.7-196-153.6-314.6-154.2l-.2-64c0-6.5-7.6-10.1-12.6-6.1l-128 101c-4 3.1-3.9 9.1 0 12.3L492 318.6c5.1 4 12.7.4 12.6-6.1v-63.9c12.9.1 25.9.9 38.8 2.5 42.1 5.2 82.1 18.2 119 38.7 38.1 21.2 71.2 49.7 98.4 84.3 27.1 34.7 46.7 73.7 58.1 115.8a325.95 325.95 0 016.5 140.9h74.9c14.8-103.6-11.3-213-81-302.3z"}}]},name:"rotate-left",theme:"outlined"},Me=function(e,t){return o.exports.createElement(b,Object.assign({},e,{ref:t,icon:Se}))};Me.displayName="RotateLeftOutlined";var Te=o.exports.forwardRef(Me),je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M480.5 251.2c13-1.6 25.9-2.4 38.8-2.5v63.9c0 6.5 7.5 10.1 12.6 6.1L660 217.6c4-3.2 4-9.2 0-12.3l-128-101c-5.1-4-12.6-.4-12.6 6.1l-.2 64c-118.6.5-235.8 53.4-314.6 154.2A399.75 399.75 0 00123.5 631h74.9c-.9-5.3-1.7-10.7-2.4-16.1-5.1-42.1-2.1-84.1 8.9-124.8 11.4-42.2 31-81.1 58.1-115.8 27.2-34.7 60.3-63.2 98.4-84.3 37-20.6 76.9-33.6 119.1-38.8z"}},{tag:"path",attrs:{d:"M880 418H352c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H396V494h440v326z"}}]},name:"rotate-right",theme:"outlined"},ze=function(e,t){return o.exports.createElement(b,Object.assign({},e,{ref:t,icon:je}))};ze.displayName="RotateRightOutlined";var Le=o.exports.forwardRef(ze),Ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}}]},name:"zoom-in",theme:"outlined"},Ae=function(e,t){return o.exports.createElement(b,Object.assign({},e,{ref:t,icon:Ie}))};Ae.displayName="ZoomInOutlined";var He=o.exports.forwardRef(Ae),Ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}}]},name:"zoom-out",theme:"outlined"},De=function(e,t){return o.exports.createElement(b,Object.assign({},e,{ref:t,icon:Ue}))};De.displayName="ZoomOutOutlined";var We=o.exports.forwardRef(De),Ve={rotateLeft:o.exports.createElement(Te,null),rotateRight:o.exports.createElement(Le,null),zoomIn:o.exports.createElement(He,null),zoomOut:o.exports.createElement(We,null),close:o.exports.createElement(E,null),left:o.exports.createElement(k,null),right:o.exports.createElement(N,null)},Ye=function(e){var t=e.prefixCls,n=e.preview,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["prefixCls","preview"]),i=o.exports.useContext(P).getPrefixCls,a=i("image",t),s=i(),c=o.exports.useContext(P).locale,u=(void 0===c?R:c).Image||R.Image,f=o.exports.useMemo((function(){if(!1===n)return n;var e="object"===l(n)?n:{};return p(p({mask:o.exports.createElement("div",{className:"".concat(a,"-mask-info")},o.exports.createElement(U,null),null==u?void 0:u.preview),icons:Ve},e),{transitionName:O(s,"zoom",e.transitionName),maskTransitionName:O(s,"fade",e.maskTransitionName)})}),[n,u]);return o.exports.createElement(Re,p({prefixCls:a,preview:f},r))};Ye.PreviewGroup=function(e){var t=e.previewPrefixCls,n=e.preview,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["previewPrefixCls","preview"]),i=o.exports.useContext(P).getPrefixCls,a=i("image-preview",t),s=i(),c=o.exports.useMemo((function(){if(!1===n)return n;var e="object"===l(n)?n:{};return p(p({},e),{transitionName:O(s,"zoom",e.transitionName),maskTransitionName:O(s,"fade",e.maskTransitionName)})}),[n]);return o.exports.createElement(Re.PreviewGroup,p({preview:c,previewPrefixCls:a,icons:Ve},r))};var Xe=Ye;const Be=new class{constructor(e){this.config=e}getUnusedResource(){return X.warpOnEvent((async e=>{const t=await T.pageToAllList(this.config.resourceApi.list.bind(this.config.resourceApi),{fields:["id","title","mime"]});let n=0;return await V.filter(t,Y((async r=>{const o=!(await this.checkUsed(r.id));return e.process({title:r.title,all:t.length,rate:n++}),o}),10))}))}async checkUsed(e){return(await this.config.searchApi.search({query:`"](:/${e})"`})).items.length>0}}(j);const Ge=function(e){const t=e();return e=>`http://localhost:${null==t?void 0:t.port}/resources/${e}/file?token=${null==t?void 0:t.token}`}((()=>L(localStorage).settings)),$e=()=>{const[e,t]=o.exports.useState([]),[n,r]=o.exports.useState(""),[i,a]=S((async()=>{try{const e=await Be.getUnusedResource().on("process",(e=>{r(B.t("unusedResource.msg.process",e))}));console.log("list: ",e),t(e)}catch(e){M.error(B.t("unusedResource.msg.error"))}}));const[s,c]=S((async()=>{await V.forEach(e,(async e=>{await j.resourceApi.remove(e.id)})),t([])}),[e]);return o.exports.createElement(A,{title:B.t("unusedResource.title"),extra:o.exports.createElement(D,null,o.exports.createElement(z,{onClick:a},B.t("unusedResource.action.check")),o.exports.createElement(z,{disabled:0===e.length,danger:!0,loading:s.loading,onClick:c},B.t("unusedResource.action.removeAll")))},o.exports.createElement(H,{dataSource:e,locale:{emptyText:B.t("unusedResource.listEmptyText")},renderItem:e=>o.exports.createElement(H.Item,{key:e.id,actions:[o.exports.createElement(z,{onClick:()=>async function(e){t(W((t=>t.filter((t=>t.id!==e))))),await j.resourceApi.remove(e)}(e.id)},B.t("unusedResource.action.remove")),o.exports.createElement(z,{onClick:()=>async function(e){await I(Ge(e))}(e.id)},B.t("unusedResource.action.download"))],extra:e.mime.startsWith("image/")&&o.exports.createElement(Xe,{src:Ge(e.id),width:300})},o.exports.createElement(H.Item.Meta,{title:e.title})),loading:{spinning:i.loading,tip:n}}))};export{$e as default};
